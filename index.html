<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>US&R Eagle Vision </title>

    <!-- localforage -->
    <script src="js/localforage.js"></script>  
    <!--Firebase -->
    <script src = "https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
    <!--Timestamp Format -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.14.1/moment.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    

<!-- 
Journey Template 
http://www.templatemo.com/tm-511-journey
-->
    
    <!-- load stylesheets -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">  <!-- Google web font "Open Sans" -->
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">                <!-- Font Awesome -->
    <link rel="stylesheet" href="css/bootstrap.min.css">                                      <!-- Bootstrap style -->
    <link rel="stylesheet" type="text/css" href="css/datepicker.css"/>
    <link rel="stylesheet" type="text/css" href="slick/slick.css"/>
    <link rel="stylesheet" type="text/css" href="slick/slick-theme.css"/>
    <link rel="stylesheet" href="css/templatemo-style.css">                                   <!-- Templatemo style -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
            <!--[if lt IE 9]>
              <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
              <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
          <![endif]-->
      </head>

      <body>
        <div class="tm-main-content" id="top">
            <div class="tm-top-bar-bg"></div>    
            <div class="tm-top-bar" id="tm-top-bar">
                <div class="container">
                    <div class="row">
                        <nav class="navbar navbar-expand-lg narbar-light">
                            <a class="navbar-brand mr-auto" href="#">
                                <img src="img/TF1.png" alt="Site logo">
                                US&R Eagle Vision
                            </a>
                            <button type="button" id="nav-toggle" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#mainNav" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                            </button>
                            <div id="mainNav" class="collapse navbar-collapse tm-bg-white">
                                <ul class="navbar-nav ml-auto">
                                  <li class="nav-item">
                                    <a class="nav-link active" href="#top">HOME <span class="sr-only">(current)</span></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#tm-section-2"></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#tm-section-3">DAMAGE/PERIMETER SEARCH</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#tm-section-4"></a>
                                </li>
                            </ul>
                        </div>                            
                    </nav>
                </div> <!-- row -->
            </div> <!-- container -->
        </div> <!-- .tm-top-bar -->

        <div class="tm-page-wrap mx-auto">
            <section class="tm-banner">
                <div class="tm-container-outer tm-banner-bg">

    <head>
            <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
            <meta charset="utf-8">
            <title>Predefined Symbols (Marker)</title>
                <style>
            #map {
                width: 100%;
                height: 720px;
                background-color: grey;
            }
        </style>
    </head>
    
    <body>
        <div id="map"></div>
        <script>

            //this function starts up the map..Rest of map functions start on line 141
            var map, infoWindow;
            function initMap() 
                
            
        </script>
      
        
        </body>                 
    </div>     <!-- .tm-container-outer -->                 
        </section>
            
                  
            <div class="tm-container-outer" id="tm-section-3">

<ul class="nav nav-pills tm-tabs-links">
                    <li id="button" class="tm-tab-link-li">
                        <a href="#1a" data-toggle="tab" class="tm-tab-link">
                            <img src="img/Str_NO_D.png" alt="Image" class="img-fluid">
                            Structure No Damage
                        </a>
                    </li>
                    <li id="button2" class="tm-tab-link-li">
                        <a href="#2a" data-toggle="tab" class="tm-tab-link">
                            <img src="img/Str_Damaged.png" alt="Image" class="img-fluid">
                            Structure Damaged
                        </a>
                    </li>
                    <li id="button3" class="tm-tab-link-li">
                        <a href="#4a" data-toggle="tab" class="tm-tab-link active"><!-- Current Active Tab -->
                            <img src="img/Str_Destroyed.png" alt="Image" class="img-fluid">
                            Structure Destroyed
                        </a>
                    </li>
                    <li id="button4" class="tm-tab-link-li">
                        <a href="#3a" data-toggle="tab" class="tm-tab-link">
                            <img src="img/Str_Failed.png" alt="Image" class="img-fluid">
                            Structure Failed
                        </a>
                    </li>
                    

                                        
                        </a>
                    </li>
                </ul>



<script>

//GLOBAL VARIABLES
var myLatLng;

  function myMap() {
    map = new google.maps.Map(document.getElementById('map'), {
      center: new google.maps.LatLng(47.2446, -122.4376),
      streetViewControl: false,
      zoom: 11
    });
  }

//actual deleting fucntion goes here

var delMarker = function (markerPar) {
    markerPar.setMap(null);
}

  
  var image = "img/Str_NO_D.png"
  var image2 = "img/Str_Damaged.png"
  var image3 = "img/Str_Destroyed.png"
  var image4 = "img/Str_Failed.png"

  function addmarker(lat, lon, info) {
    //new deleting here

    marker = new google.maps.Marker({
      position: new google.maps.LatLng(lat, lon),
      draggable: true,
      info: new google.maps.InfoWindow({
        content: info
      }),
      map: map,
      icon: image
    });

    google.maps.event.addListener(marker, 'dragend', function(ev){
     myLatLng = marker.getPosition().toString();
     console.log(myLatLng);
    });

   
    google.maps.event.addListener(marker, 'click', function (point) {delMarker(marker)}, 'click', function() {
      marker.info.open(map, marker);
    });

    map.panTo(marker.getPosition());
  }

  function addmarker2(lat, lon, info) {
    marker = new google.maps.Marker({
      position: new google.maps.LatLng(lat, lon),
      draggable: true,
      info: new google.maps.InfoWindow({
        content: info
      }),
      map: map,
      icon: image2
    });

    google.maps.event.addListener(marker, 'dragend', function(ev){
     myLatLng = marker.getPosition().toString();
     console.log(myLatLng);
    });

   
    google.maps.event.addListener(marker, 'click', function (point) {delMarker(marker)}, 'click', function() {
      marker.info.open(map, marker);
    });

    map.panTo(marker.getPosition());
  }

  function addmarker3(lat, lon, info) {
    marker = new google.maps.Marker({
      position: new google.maps.LatLng(lat, lon),
      draggable: true,
      info: new google.maps.InfoWindow({
        content: info
      }),
      map: map,
      icon: image3
    });

    google.maps.event.addListener(marker, 'dragend', function(ev){
     myLatLng = marker.getPosition().toString();
     console.log(myLatLng);
    });

   
    google.maps.event.addListener(marker, 'click', function (point) {delMarker(marker)}, 'click', function() {
      marker.info.open(map, marker);
    });

    map.panTo(marker.getPosition());
  }

    function addmarker4(lat, lon, info) {
    marker = new google.maps.Marker({
      position: new google.maps.LatLng(lat, lon),
      draggable: true,
      info: new google.maps.InfoWindow({
        content: info
      }),
      map: map,
      icon: image4
    });

    google.maps.event.addListener(marker, 'dragend', function(ev){
     myLatLng = marker.getPosition().toString();
     console.log(myLatLng);
    });

   
    google.maps.event.addListener(marker, 'click', function (point) {delMarker(marker)}, 'click', function() {
      marker.info.open(map, marker);
    });

    map.panTo(marker.getPosition());
  }

</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCXvJ72oaaTTtLCj5XYS2EcPyMtEb1kyWQ&callback=myMap"></script>


<script>
$('#button').click(function() {
  addmarker('47.2446', '-122.4376');
});

$('#button2').click(function() {
  addmarker2('47.2446', '-122.5567');
});

$('#button3').click(function() {
  addmarker3('47.2446', '-122.2225');
});

$('#button4').click(function() {
  addmarker4('47.2446', '-122.2335');
});
</script>

<script>

// HTML5 geolocation.
        infoWindow = new google.maps.InfoWindow;
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
            var pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };

            infoWindow.setPosition(pos);
            infoWindow.setContent('Your Location.');
            infoWindow.open(map);
            map.setCenter(pos);
          }, function() {
            handleLocationError(true, infoWindow, map.getCenter());
          });
        } else {
          // Browser doesn't support Geolocation
          handleLocationError(false, infoWindow, map.getCenter());
        }
      

      function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
                              'Error: The Geolocation service failed.' :
                              'Error: Your browser doesnt support geolocation.');
        infoWindow.open(map);
        
             }

</script>


 <section class="p-5 tm-container-outer tm-bg-gray">            
                <div class="container">
                    <div class="row">
                        <div class="col-xs-12 mx-auto tm-about-text-wrap text-center">                        

    <div class="row">
      <div class="col-25">
        <label for="Structure">Type of Structure Damage</label>
      </div>
      <div class="col-75">
        <select id="select_id" name="Damage">
          <option value="Structure No Damage">Structure No Damage</option>
          <option value="Structure Damaged">Structure Damaged</option>
          <option value="Structure Failed">Structure Failed</option>
          <option value="Structure Destroyed">Structure Destroyed</option>
        
        </select>
      </div>
    </div>
    <div class="row">
      <div class="col-25">
        <label for="PERIMETER">Type of Perimeter Search</label>
      </div>
      <div class="col-75">
        <select id="select_id1" name="Perimeter">
          <option value="Targeted Search">Targeted Search</option>
          <option value="Recon">Recon</option>
          <option value="Hasty Rapid">Hasty Rapid</option>
          <option value="Primary">Primary</option>
          <option value="Secondary Low">Secondary Low</option>
          <option value="Secondary High">Secondary High</option>
          
        </select>
      </div>
    </div>
   
    <div class="row">
      <div class="col-25">
        <label for="Description">Description</label>
      </div>
      <form action="" onsubmit="event.preventDefault(); sConsole(); reset();"> <!-- use inline JS to print input to console on submit -->

<input type="text" name="data" id="data">
<button type="submit", onclick="savedata(), myFunction()">Submit</button>
</form>

<!-- Notification of data upload -->
<script>
function myFunction() {
  alert("Successful Upload")
}
</script>

<!--Firebase functions to the Realtime Database -->
<script>
function sConsole() {
  var data1 = document.getElementById("data").value;
  var peri1 = document.getElementById("select_id1");
  var peri2 = peri1.options[peri1.selectedIndex].text;
  var struc1 = document.getElementById("select_id");
  var struc2 = struc1.options[struc1.selectedIndex].text;
  

  var obj = '{data: '+data1 +', peri: '+peri2 +', struc: '+struc2+'}';
    
    //myJSON = JSON.stringify(obj);
    //console.log(obj);

    }
  </script>



<script>

   
    // Save data to firebase
    function savedata(){
      var messagesRef = new Firebase('https://usr-eagle-view.firebaseio.com');
      var data1 = document.getElementById("data").value;
      var peri1 = document.getElementById("select_id1");
      var peri2 = peri1.options[peri1.selectedIndex].text;
      var struc1 = document.getElementById("select_id");
      var struc2 = struc1.options[struc1.selectedIndex].text;
      var messageField = document.getElementById('data');
      var messageResults = document.getElementById('results');
      var m = moment().format('MMMM Do YYYY, h:mm:ss a');
      var message = messageField.value;
      messagesRef.push(
        {Description: message, Perimeter: peri2, Structure: struc2, Timestamp: m, MarkerLocation: myLatLng}


      );
      messageField.value = '';
    }
    
    //localForage offline storage

    localForage.setItem('message', message, function(result) {
  console.log(result);
});

   

    </script>


    </div>
    
                             
                        </div>
                    </div>
                </div>            
            </section>
    

            <!-- .tm-container-outer -->

            <footer class="tm-container-outer">
                <p class="mb-0">Copyright © <span class="tm-current-year">2019</span> University of Washington Tacoma, MSGT Program
                    
                . Designed by <a rel="nofollow" target="_parent">Greg Mireles</a></p>
            </footer>
        </div>
    </div> <!-- .main-content -->



    <!-- load JS files --> 
    <script src="js/jquery-1.11.3.min.js"></script>             <!-- jQuery (https://jquery.com/download/) -->
    <script src="js/popper.min.js"></script>                    <!-- https://popper.js.org/ -->       
    <script src="js/bootstrap.min.js"></script>                 <!-- https://getbootstrap.com/ -->
    <script src="js/datepicker.min.js"></script>                <!-- https://github.com/qodesmith/datepicker -->
    <script src="js/jquery.singlePageNav.min.js"></script>      <!-- Single Page Nav (https://github.com/ChrisWojcik/single-page-nav) -->
    <script src="slick/slick.min.js"></script>                  <!-- http://kenwheeler.github.io/slick/ -->
    <script src="js/jquery.scrollTo.min.js"></script>           <!-- https://github.com/flesler/jquery.scrollTo -->
    

    <script>
        /* DOM is ready
        ------------------------------------------------*/
        $(function(){

            // Change top navbar on scroll
            $(window).on("scroll", function() {
                if($(window).scrollTop() > 100) {
                    $(".tm-top-bar").addClass("active");
                } else {                    
                 $(".tm-top-bar").removeClass("active");
                }
            });

            // Smooth scroll to search form
            $('.tm-down-arrow-link').click(function(){
                $.scrollTo('#tm-section-search', 300, {easing:'linear'});
            });

            // Date Picker in Search form
            var pickerCheckIn = datepicker('#inputCheckIn');
            var pickerCheckOut = datepicker('#inputCheckOut');

            // Update nav links on scroll
            $('#tm-top-bar').singlePageNav({
                currentClass:'active',
                offset: 60
            });

            // Close navbar after clicked
            $('.nav-link').click(function(){
                $('#mainNav').removeClass('show');
            });

            // Slick Carousel
            $('.tm-slideshow').slick({
                infinite: true,
                arrows: true,
                slidesToShow: 1,
                slidesToScroll: 1
            });


    </script>             

</body>
</html>